import pandas as pd
import pytorch_lightning as pl
import torch
import torch.autograd as autograd
import torch.nn as nn
import torch.nn.functional as F
import torch.optim as optim
from torch.utils.data import Dataset, DataLoader
from sklearn.metrics import accuracy_score as accuracy
#Für eine bessere Überprüfbarkeit der Resultate habe ich meine hier eingefügt
#vorhersagen des ersten lstm:
this_predictions = [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1]
#labels
this_labels = [1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0]
#die komischen namen sind damit ich ja nicht eine zweite variable gleich nenne

v1 = [-0.07988482713699341, -0.07321083545684814, -0.07371369004249573, -0.0842774286866188, -0.10127533972263336, -0.0911196693778038, -0.061942681670188904, -0.02920432761311531, -0.0013117939233779907, 0.020579202100634575, 0.03808697313070297, 0.0474342480301857, 0.054473668336868286, 0.06447681039571762, 0.07888728380203247, 0.0789198949933052, 0.0617440864443779, 0.03897538781166077, 0.007438046857714653, -0.010921269655227661, -0.042115792632102966, -0.08253699541091919, -0.09946589171886444, -0.11918772757053375, -0.14336130023002625, -0.12776289880275726, -0.0882561206817627, -0.06734996289014816, -0.062271684408187866, -0.04244831204414368, -0.038015417754650116, -0.05492623895406723, -0.06874043494462967, -0.05668788403272629, -0.05029607564210892, -0.056855812668800354, -0.04667385295033455, -0.04980991780757904, -0.038032956421375275, -0.01516558974981308, 0.006733531132340431, 0.004396578297019005, 0.009665941819548607, 0.0015532877296209335, 0.005719540640711784, -0.0017082802951335907, -0.01699797809123993, -0.013744066469371319, -0.018450137227773666, -0.012184657156467438, -0.008796194568276405, -0.006818175315856934, -0.011568629182875156, 0.027965394780039787, 0.04064095765352249, 0.04444694519042969, 0.04770779609680176, 0.07982558012008667, 0.08167117834091187, 0.047419629991054535, 0.04610249400138855, 0.02706793136894703, 0.02144896425306797, 0.030479872599244118, 0.02341943420469761, 0.0007080323994159698, -0.030387701466679573, -0.06497254222631454, -0.07072501629590988, -0.046950891613960266, -0.03324160724878311, 0.0011215675622224808, 0.026645755395293236, 0.043672122061252594, 0.041845448315143585, 0.06844165921211243, 0.06848543137311935, 0.04362345486879349, 0.043235838413238525, 0.02191135473549366, 0.023664051666855812, 0.0324840173125267, 0.04547295719385147, 0.05091635882854462, 0.07275870442390442, 0.04922656714916229, 0.030938776209950447, 0.006179437041282654, 0.012063516303896904, 0.034213848412036896, 0.014844512566924095, 0.022708820179104805, 0.021184546872973442, 0.02593100629746914, 0.03194040805101395, 0.006306847557425499, -0.03257030248641968, -0.0527622289955616, -0.049212850630283356, -0.029354803264141083, -0.02878013625741005, -0.0513143464922905, -0.0650428831577301, -0.08276131749153137, -0.1259072870016098, -0.17401070892810822, -0.18449999392032623, -0.1638941913843155, -0.15318019688129425, -0.13734999299049377, -0.10499098896980286, -0.10262077301740646, -0.0940055325627327, -0.10536640882492065, -0.13205485045909882, -0.16255371272563934, -0.1917378008365631, -0.18309509754180908, -0.14563772082328796, -0.1276085525751114, -0.1262134611606598, -0.13332600891590118, -0.13825422525405884, -0.10821162164211273, -0.08552651107311249, -0.07278919965028763, -0.04344068467617035, -0.03161858767271042, -0.013823239132761955, 0.004593586549162865, 0.002578074112534523, 0.009942179545760155, 0.002682223916053772, -0.014361322857439518, -0.01432938314974308, -0.0009214691817760468, -0.006273113191127777, -0.025937849655747414, -0.052262816578149796, -0.05596490204334259, -0.038363996893167496, -0.034356940537691116, -0.04257535934448242, -0.053825244307518005, -0.03893478959798813, -0.0015508513897657394, 0.039204925298690796, 0.03657923638820648, 0.01401660405099392, 0.03747042268514633, 0.03867732733488083, 0.025270434096455574, 0.025189461186528206, 0.017593396827578545, 0.02412535808980465, 0.039954133331775665, 0.05657797306776047, 0.05599132925271988, 0.0485418364405632, 0.041796937584877014, 0.06787139177322388, 0.04087488353252411, 0.031167110428214073, 0.026497526094317436, -0.007961665280163288, -0.054306432604789734, -0.07940813899040222, -0.11646633595228195, -0.1589730829000473, -0.16543951630592346, -0.13064561784267426, -0.10325000435113907, -0.06854154169559479, -0.029763072729110718, -0.024630872532725334, -0.020470386371016502, -0.03356810286641121, -0.02481282502412796, -0.006496084854006767, -0.017952386289834976, -0.012733588926494122, 0.0004855189472436905, -0.014581055380403996, -0.03629563748836517, -0.07437431812286377, -0.08253739774227142, -0.06434983015060425, -0.06057407706975937, -0.07408992946147919, -0.09529504925012589, -0.11693979054689407, -0.1058397889137268, -0.10127260535955429, -0.07932072877883911, -0.04643210768699646, -0.03757435828447342, -0.04319053515791893, -0.05667458474636078, -0.07206172496080399, -0.09319739788770676, -0.0783483237028122, -0.06628362834453583, -0.07053110003471375, -0.08228453248739243, -0.0926976129412651, -0.07676012814044952, -0.04140900820493698, -0.026738563552498817, -0.006062796339392662, -0.003994850441813469, 0.002940915524959564, 0.015499455854296684, 0.03124633990228176, 0.04745809733867645, 0.04402560740709305, 0.038352176547050476, 0.041427575051784515, 0.03198983520269394, 0.034181661903858185, 0.04980321228504181, 0.06618378311395645, 0.06387851387262344, 0.058973632752895355, 0.04034098982810974, 0.03258887678384781, 0.02484130673110485, 0.02171478606760502, 0.024433480575680733, 0.033728405833244324, 0.04599107801914215, 0.03933993726968765, 0.033690206706523895, 0.014691324904561043, -0.017813365906476974, -0.03412282094359398, -0.029381312429904938, -0.035133734345436096, -0.03041454404592514, -0.040118105709552765, -0.06616771966218948, -0.10456816107034683, -0.11542566120624542, -0.09245645999908447, -0.08039045333862305, -0.04848618805408478, -0.0454002320766449, -0.059357598423957825, -0.04552120715379715, -0.027419796213507652, -0.0059480126947164536, -0.008046088740229607, -0.003487866371870041, -0.009040857665240765, -0.034702133387327194, -0.040319934487342834, -0.024362865835428238, -0.007937399670481682, 0.009294318035244942, 0.0017319303005933762, -0.0003927759826183319, 0.00820213370025158, -0.005060570314526558, -0.0020237211138010025, 0.01718970201909542, -0.000739220529794693, -0.031506359577178955, -0.032388754189014435, -0.033680837601423264, 0.0001964997500181198, 0.027079829946160316, 0.023526953533291817, -0.0009129997342824936, -0.016884800046682358, -0.0330338329076767, -0.06838691234588623, -0.10134640336036682, -0.11214804649353027, -0.1296333521604538, -0.12572532892227173, -0.09551772475242615, -0.05800405144691467, -0.05243121460080147, -0.06316341459751129, -0.056788742542266846, -0.06892286986112595, -0.09088043868541718, -0.09051734209060669, -0.0730758085846901, -0.0760040283203125, -0.09737204015254974, -0.12672390043735504, -0.15711478888988495, -0.15503953397274017, -0.15832379460334778, -0.17267078161239624, -0.162071093916893, -0.12975743412971497, -0.12189174443483353, -0.13618376851081848, -0.16132760047912598, -0.15602444112300873, -0.12646184861660004, -0.08926837146282196, -0.08293841779232025, -0.09951015561819077, -0.09370840340852737, -0.06987851858139038, -0.04171796143054962, -0.01801297254860401, -0.022894399240612984, -0.02273651957511902, -0.01498611643910408, -0.026898471638560295, -0.054883867502212524, -0.08942314237356186, -0.09757023304700851, -0.08284155279397964, -0.05872581899166107, -0.060656048357486725, -0.05612664669752121, -0.04271974414587021, -0.05036383867263794, -0.04939159378409386, -0.0610712394118309, -0.0571502149105072, -0.07231248915195465, -0.09970171004533768, -0.10377255827188492, -0.08549174666404724, -0.05262679606676102, -0.03059326484799385, -0.03709083050489426, -0.06321297585964203, -0.06475511193275452, -0.0752190425992012, -0.1084078848361969, -0.14127279818058014, -0.14018413424491882, -0.11238966882228851, -0.07555574178695679, -0.042224325239658356, -0.0413878858089447, -0.03498814254999161, -0.04342938959598541, -0.06311509013175964, -0.06636504828929901, -0.0505070835351944, -0.02789437770843506, -0.029247749596834183, -0.02738809399306774, -0.017510615289211273, -0.025712955743074417, -0.05071517825126648, -0.07881224155426025, -0.10513574630022049, -0.12028233706951141, -0.09896700829267502, -0.08326929807662964, -0.07844892144203186, -0.05299844220280647, -0.017338095232844353, -0.004288645461201668, -0.0027982275933027267, -0.009341809898614883, 0.012844657525420189, 0.05451854318380356, 0.09503408521413803, 0.10213219374418259, 0.08254709839820862, 0.07092931121587753, 0.07047197222709656, 0.09104111045598984, 0.09247211366891861, 0.11135894805192947, 0.11850263923406601, 0.11959215253591537, 0.10311245173215866, 0.07388298213481903, 0.06134273111820221, 0.0603090301156044, 0.05101723223924637, 0.029367143288254738, 0.02073783241212368, 0.008286993950605392, 0.011156151071190834, 0.029477255418896675, 0.03630989044904709, 0.029839767143130302, 0.03597693145275116, 0.05290667712688446, 0.05464322119951248, 0.041190095245838165, 0.04006417095661163, 0.05190210044384003, 0.06904328614473343, 0.06859426945447922, 0.07098651677370071, 0.07960889488458633, 0.09014391154050827, 0.10070572048425674, 0.09232556074857712, 0.08597678691148758, 0.08611024916172028, 0.07167569547891617, 0.03950411081314087, -0.005959171801805496, -0.050023965537548065, -0.10337502509355545, -0.15718121826648712, -0.1740218549966812, -0.14530900120735168, -0.11731868237257004, -0.09772516041994095, -0.059382662177085876, -0.012758835218846798, 0.02771732397377491, 0.061122357845306396, 0.08285193890333176, 0.07051920145750046, 0.05863872915506363, 0.07044494897127151, 0.08199124038219452, 0.06219425052404404, 0.04623975604772568, 0.01799592934548855, 0.015202028676867485, 0.007745709270238876, 0.010486682876944542, -0.00569918192923069, -0.01328625250607729, -0.030415140092372894, -0.04186960309743881, -0.06462279707193375, -0.09445792436599731, -0.09795089811086655, -0.10813479125499725, -0.10443970561027527, -0.08153953403234482, -0.07447311282157898, -0.060154274106025696, -0.06456858664751053, -0.05648995190858841, -0.03588910400867462, -0.03833099827170372, -0.03443273529410362, -0.024202244356274605, -0.010531353764235973, -0.020225204527378082, -0.042471274733543396, -0.052608802914619446, -0.06960181891918182, -0.0960284173488617, -0.12556219100952148, -0.15625858306884766, -0.15020528435707092, -0.11324199289083481, -0.09666285663843155, -0.09557414054870605, -0.09214930981397629, -0.08271880447864532, -0.06965475529432297, -0.04243285208940506, -0.03211609646677971, -0.01217992790043354, -0.013968372717499733, 0.00028268061578273773, -0.006083305925130844, -0.02120831422507763, -0.016106249764561653, -0.003942988812923431, 0.015214046463370323, 0.026791786774992943, 0.014440523460507393, -0.012362075969576836, -0.054747991263866425, -0.10116638988256454, -0.14576482772827148, -0.1832655668258667, -0.17983393371105194, -0.1732090413570404, -0.14690187573432922, -0.10689236968755722, -0.06079573929309845, -0.04035666212439537, -0.021129636093974113, -0.024487793445587158, -0.03413081914186478, -0.05256945639848709, -0.07594726234674454, -0.10019698739051819, -0.12465841323137283, -0.11430200934410095, -0.08088568598031998, -0.06719601154327393, -0.06821505725383759, -0.05237255245447159, -0.04909759387373924, -0.0566498339176178, -0.07058805972337723, -0.0844753161072731, -0.09424686431884766, -0.09960032999515533, -0.1022108644247055, -0.07818875461816788, -0.0409202054142952, -0.002799779176712036, 0.009224513545632362, 0.02636312134563923, 0.016598640009760857, 0.02818790264427662, 0.03499710559844971, 0.04537928104400635, 0.03727521747350693, 0.03902917355298996, 0.0224213395267725, -0.0018784794956445694, -0.007889654487371445, -0.018992871046066284, -0.03558778017759323, -0.056354209780693054, -0.05697431415319443, -0.07369677722454071, -0.06761056929826736, -0.056717753410339355, -0.031000811606645584, -0.037444207817316055, -0.018021846190094948, 0.008028576150536537, 0.01079663448035717, -0.005322873592376709, -0.033029623329639435, -0.06730398535728455, -0.10460328310728073, -0.11244434118270874, -0.08843731880187988, -0.050283655524253845, -0.011133000254631042, -0.011921078898012638, -0.003884861245751381, -0.01926003396511078, -0.041380975395441055, -0.043106287717819214, -0.0308217890560627, -0.04029812291264534, -0.039080217480659485, -0.027814986184239388, -0.014964411035180092, -0.022067448124289513, -0.01932423561811447, -0.0022736266255378723, 0.0005562696605920792, 0.023859122768044472, 0.026598578318953514, 0.044887475669384, 0.04313720017671585, 0.03829944133758545, 0.0018066111952066422, -0.014752062037587166, -0.001887509599328041, 0.02793302573263645, 0.0525238960981369, 0.06761041283607483, 0.08050106465816498, 0.09247583895921707, 0.10212203115224838, 0.09192900359630585, 0.08147741854190826, 0.065848208963871, 0.054996103048324585, 0.05179101228713989, 0.05459614098072052, 0.042735323309898376, 0.03484952449798584, 0.012708550319075584, -0.021457990631461143, -0.06597337871789932, -0.08806880563497543, -0.08070797473192215, -0.05274667963385582, -0.01724213734269142, -0.009105464443564415, -0.00045831501483917236, 0.01399911381304264, 0.030699724331498146, 0.045164600014686584, 0.071428582072258, 0.08596323430538177, 0.09397318214178085, 0.08048858493566513, 0.06927531212568283, 0.06424125283956528, 0.062137044966220856, 0.04015348106622696, 0.002700459212064743, -0.013971981592476368, -0.019275357946753502, -0.028060732409358025, -0.023430047556757927, -0.048780012875795364, -0.04786223918199539, -0.02226412668824196, 0.02716151811182499, 0.05436721444129944, 0.07821601629257202, 0.09001768380403519, 0.08774377405643463, 0.07478461414575577, 0.07305622845888138, 0.08165118098258972, 0.09478292614221573, 0.10537850111722946, 0.11433159559965134, 0.12070778757333755, 0.12512247264385223, 0.12822796404361725, 0.11550670117139816, 0.1050819531083107, 0.08334987610578537, 0.04739178717136383, 0.023863816633820534, 0.015971461310982704, 0.02083698846399784, 0.008803719654679298, 0.00432390533387661, -0.011359668336808681, -0.03971660137176514, -0.07382088899612427, -0.08086763322353363, -0.0855802595615387, -0.06715702265501022, -0.05713123828172684, -0.03606767952442169, -0.0048152487725019455, 0.005640096962451935, -0.0036313924938440323, 0.005089517682790756, 0.027843093499541283, 0.04961276054382324, 0.04343339055776596, 0.011455198749899864, -0.009207716211676598, -0.03620821237564087, -0.04240591824054718, -0.03136863559484482, -0.013449948281049728, -0.015164228156208992, -0.012191726826131344, -0.021937789395451546, -0.01429140754044056, -0.03275415301322937, -0.03178534284234047, -0.01603664830327034, -0.011668737046420574, -0.03520891070365906, -0.02224494330585003, 0.0040977708995342255, 0.002623705193400383, 0.005920909345149994, 0.023457752540707588, 0.03928641229867935, 0.03850710391998291, 0.011699410155415535, -0.04055552929639816, -0.041862234473228455, -0.030829550698399544, -0.017583070322871208, -0.03028441220521927, -0.049499135464429855, -0.061924248933792114, -0.06895133852958679, -0.0737897977232933, -0.0574825182557106, -0.043271131813526154, -0.0432823970913887, -0.05649089813232422, -0.07179775089025497, -0.07058990746736526, -0.04103567451238632, -0.03826805576682091, -0.018381770700216293, -0.006512288004159927, 0.008163141086697578, 0.005698971450328827, 0.014598054811358452, 0.011908626183867455, 0.01847243867814541, 0.015612075105309486, 0.004418274387717247, 0.005666464567184448, 0.013049321249127388, 0.028483392670750618, 0.04967886954545975, 0.055000267922878265, 0.033471621572971344, 0.022265469655394554, -0.001597583293914795, 0.002437928691506386, 0.015446441248059273, 0.02637208066880703, 0.03817374259233475, 0.03125642240047455, 0.028989093378186226, 0.03447313606739044, 0.0472121462225914, 0.06006145477294922, 0.07208957523107529, 0.0648277997970581, 0.04072681814432144]
v2 = [-0.08703438192605972, -0.09756433218717575, -0.09862595051527023, -0.09053579717874527, -0.08550945669412613, -0.105071060359478, -0.1328728199005127, -0.16144078969955444, -0.17392128705978394, -0.17530402541160583, -0.16707175970077515, -0.16587623953819275, -0.15873616933822632, -0.14115574955940247, -0.11543325334787369, -0.11481369286775589, -0.08775792270898819, -0.025936074554920197, 0.05664069578051567, 0.12482403963804245, 0.1768452227115631, 0.2176605463027954, 0.1902858018875122, 0.13578835129737854, 0.0696823000907898, 0.061467744410037994, -0.047380559146404266, -0.02886292338371277, 0.007090553641319275, 0.0029038116335868835, 0.0055137500166893005, -0.014397360384464264, 0.01376655139029026, 0.0022339485585689545, -0.0072273798286914825, -0.026325620710849762, -0.06343249976634979, -0.08396472781896591, -0.11330456286668777, -0.1442107856273651, -0.16329413652420044, -0.1526814103126526, -0.1494859755039215, -0.13315939903259277, -0.1308879852294922, -0.11687623709440231, -0.09294376522302628, -0.08758331090211868, -0.06714338809251785, -0.0795358270406723, -0.05163884907960892, 0.015624534338712692, -0.028566740453243256, 0.01304117776453495, 0.05416502431035042, -0.008675437420606613, -0.06910452246665955, -0.030817970633506775, 0.020789651200175285, 0.0025465935468673706, 0.07002794742584229, 0.11623609066009521, 0.12578031420707703, 0.09813310205936432, 0.11586923897266388, 0.1427142471075058, 0.16295747458934784, 0.19553008675575256, 0.17680838704109192, 0.11089015752077103, 0.04054180532693863, 0.04760259389877319, -0.03606042265892029, -0.0002529136836528778, -0.054839134216308594, -0.016383375972509384, 0.019476141780614853, 0.017817802727222443, 0.057131577283144, 0.04392741620540619, 0.07764691859483719, 0.08230924606323242, 0.04110516235232353, -0.024046458303928375, 0.006999790668487549, -0.032930538058280945, -0.05852603167295456, -0.050426043570041656, -0.010415412485599518, 0.04517226666212082, 0.02047494426369667, 0.07865924388170242, 0.025584328919649124, -0.014939691871404648, 0.07124478369951248, 0.1300671100616455, 0.17386305332183838, 0.1872374713420868, 0.16687791049480438, 0.12807731330394745, 0.12489943951368332, 0.12576422095298767, 0.09137865155935287, 0.12184789031744003, 0.0935322642326355, 0.04311593621969223, 0.09000353515148163, 0.07034800946712494, -0.009279996156692505, -0.01654726266860962, -0.08825033158063889, -0.1146778091788292, -0.13534504175186157, -0.12715980410575867, -0.10502002388238907, -0.07805553078651428, -0.06643969565629959, -0.0862191691994667, -0.13351944088935852, -0.15072482824325562, -0.14596688747406006, -0.13765352964401245, -0.13315731287002563, -0.1608346700668335, -0.17314016819000244, -0.17352497577667236, -0.18844690918922424, -0.18571344017982483, -0.18833547830581665, -0.190034419298172, -0.1703282594680786, -0.16284239292144775, -0.14451006054878235, -0.11730741709470749, -0.10981165617704391, -0.11371824890375137, -0.10625121742486954, -0.08548807352781296, -0.05519954860210419, -0.06147267669439316, -0.08646073192358017, -0.08397001773118973, -0.08071079850196838, -0.059199944138526917, -0.04522287845611572, -0.012762438505887985, 0.022002357989549637, -0.02492167055606842, -0.04696468263864517, 0.0173245370388031, 0.059968121349811554, 0.09201817214488983, 0.09659253805875778, 0.08475446701049805, 0.0858941301703453, 0.07235488295555115, 0.02173757739365101, 0.04389799013733864, -0.0035739876329898834, -0.05622515082359314, -0.018667541444301605, -0.05436225235462189, 0.02154098078608513, 0.08039380609989166, 0.05233152210712433, 0.04128079116344452, 0.13466385006904602, 0.21260479092597961, 0.2499982714653015, 0.19993102550506592, 0.08160655200481415, 0.07613375782966614, 0.034754738211631775, -0.008354101330041885, -0.04616030305624008, -0.09227392822504044, -0.11203602701425552, -0.09197499603033066, -0.09160805493593216, -0.1102825179696083, -0.09458678215742111, -0.0879603698849678, -0.09352045506238937, -0.05658649653196335, -0.045949749648571014, -0.0598742738366127, -0.09202473610639572, -0.09248623996973038, -0.08929074555635452, -0.07840830087661743, -0.0692233294248581, -0.0870048925280571, -0.09387006610631943, -0.12287215143442154, -0.14473947882652283, -0.12899145483970642, -0.07351715862751007, -0.008798643946647644, 0.029772190377116203, -0.009680673480033875, -0.07845241576433182, -0.07266774028539658, -0.10148239880800247, -0.10569006949663162, -0.08757498115301132, -0.1179056391119957, -0.14310073852539062, -0.15799272060394287, -0.17096513509750366, -0.15634191036224365, -0.15509986877441406, -0.15745043754577637, -0.1558375358581543, -0.15027669072151184, -0.11829835921525955, -0.1126212552189827, -0.11079061776399612, -0.07895782589912415, -0.05064386874437332, -0.018564295023679733, 0.016440831124782562, -0.025025993585586548, 0.03362242504954338, 0.012864390388131142, -0.004082482308149338, 0.04906751960515976, 0.09375882148742676, 0.1139577254652977, 0.10887470096349716, 0.09863095730543137, 0.09654204547405243, 0.11064109206199646, 0.13408273458480835, 0.1666518747806549, 0.1760430932044983, 0.15879470109939575, 0.1523735225200653, 0.14072807133197784, 0.13626933097839355, 0.15790796279907227, 0.17373859882354736, 0.1450464427471161, 0.061096254736185074, -0.02758411318063736, -0.009757965803146362, -0.06511794775724411, -0.089823417365551, -0.05330801010131836, -0.10815904289484024, -0.14621320366859436, -0.14348003268241882, -0.14348158240318298, -0.10854864865541458, -0.08993750065565109, -0.09095165878534317, -0.08669567853212357, -0.11379248648881912, -0.13170266151428223, -0.11948945373296738, -0.11309400945901871, -0.10521896928548813, -0.09049686044454575, -0.0711020678281784, -0.04311174899339676, -0.053254738450050354, -0.0373956561088562, 0.006724964827299118, -0.026377186179161072, 0.03018535114824772, 0.07547612488269806, 0.09788820147514343, 0.11089562624692917, 0.09009482711553574, 0.13237184286117554, 0.11814014613628387, 0.17527440190315247, 0.17881491780281067, 0.1451348215341568, 0.054373838007450104, -0.05823497474193573, -0.04621100425720215, -0.10393746942281723, -0.044462695717811584, -0.024978406727313995, -0.054298773407936096, -0.07069782167673111, -0.0957896038889885, -0.12351173907518387, -0.10797704011201859, -0.09740517288446426, -0.07934996485710144, -0.05550110340118408, -0.07790064066648483, -0.0887100026011467, -0.08217117190361023, -0.09864658862352371, -0.1381492018699646, -0.1448114514350891, -0.12943542003631592, -0.10779089480638504, -0.11675187200307846, -0.14502891898155212, -0.17536383867263794, -0.16806936264038086, -0.14141005277633667, -0.14076989889144897, -0.16052529215812683, -0.17535415291786194, -0.18590104579925537, -0.16728374361991882, -0.15684941411018372, -0.15322795510292053, -0.1316755712032318, -0.10216372460126877, -0.07042942941188812, -0.07030811160802841, -0.09509067982435226, -0.1226932480931282, -0.11639300733804703, -0.11676187068223953, -0.123586006462574, -0.1070731058716774, -0.11206581443548203, -0.09074068814516068, -0.07687830924987793, -0.08150646835565567, -0.0680840015411377, -0.05393417924642563, -0.022376708686351776, 0.006444431841373444, -0.07572740316390991, -0.10563155263662338, -0.09537225216627121, -0.056738436222076416, -0.0020022541284561157, -0.032164737582206726, -0.04193659871816635, -0.06909985095262527, -0.11093630641698837, -0.14174014329910278, -0.17077311873435974, -0.16148415207862854, -0.15259379148483276, -0.12564393877983093, -0.08566255122423172, -0.1007939949631691, -0.12437077611684799, -0.14532440900802612, -0.12875348329544067, -0.13000747561454773, -0.1363927125930786, -0.11531577259302139, -0.0927484855055809, -0.06075727939605713, -0.05095195025205612, -0.037176840007305145, -0.04749080538749695, -0.09135813266038895, -0.10959277302026749, -0.13952526450157166, -0.16968539357185364, -0.16304433345794678, -0.13869640231132507, -0.13313573598861694, -0.12176185101270676, -0.08998654037714005, -0.05599720776081085, -0.09043040126562119, -0.09810713678598404, -0.09998426586389542, -0.09937631338834763, -0.0639076754450798, -0.07144991308450699, -0.026330575346946716, 0.01997416466474533, 0.001718081533908844, 0.0071372054517269135, 0.03463676571846008, 0.08467736840248108, 0.07495635747909546, 0.07953827828168869, 0.12742045521736145, 0.14405162632465363, 0.15637274086475372, 0.14844141900539398, 0.12453482300043106, 0.11468333750963211, 0.12207909673452377, 0.11427905410528183, 0.094386525452137, 0.0930812656879425, 0.11033860594034195, 0.11127393692731857, 0.09794476628303528, 0.07892893999814987, 0.08080489188432693, 0.07743768393993378, 0.06723401695489883, 0.06414160877466202, 0.054031260311603546, 0.06476453691720963, 0.06929805874824524, 0.06193643808364868, 0.06314502656459808, 0.07644794881343842, 0.10181701928377151, 0.19419169425964355, 0.24984079599380493, 0.27182409167289734, 0.2360609769821167, 0.19729262590408325, 0.15027186274528503, 0.09657478332519531, 0.04666946455836296, -0.02394704520702362, -0.0879271849989891, -0.0966523215174675, -0.09669915586709976, -0.09081102162599564, -0.09394263476133347, -0.06526899337768555, -0.04617410898208618, -0.03998696804046631, -0.045660004019737244, -0.03435634821653366, 0.000558413565158844, -0.020767122507095337, -0.04535945504903793, -0.04087495058774948, -0.04145935922861099, -0.009041879326105118, -0.015939153730869293, -0.009888656437397003, 0.03484094887971878, 0.0814165398478508, 0.15406295657157898, 0.168746680021286, 0.13798843324184418, 0.11970985680818558, 0.08464587479829788, 0.06756691634654999, 0.05123940855264664, 0.02004380337893963, -0.0007725581526756287, -0.03744002431631088, -0.09035257250070572, -0.13174745440483093, -0.13040798902511597, -0.0890728160738945, -0.09432759135961533, -0.08743191510438919, -0.07110569626092911, -0.04645252972841263, -0.03765420615673065, -0.054338738322257996, -0.10822523385286331, -0.12975019216537476, -0.13150539994239807, -0.12992385029792786, -0.14001592993736267, -0.14444810152053833, -0.1668994128704071, -0.15852448344230652, -0.1501404047012329, -0.1485094130039215, -0.1336580514907837, -0.1328326165676117, -0.11780024319887161, -0.10692467540502548, -0.12286026030778885, -0.12116240710020065, -0.13300791382789612, -0.11551561206579208, -0.07259239256381989, -0.040286943316459656, -0.009920388460159302, 0.011017035692930222, 0.028640609234571457, 0.007078740745782852, -0.03437460958957672, -0.06434790790081024, -0.07843117415904999, -0.07336091250181198, -0.05859725922346115, -0.11494850367307663, -0.13654553890228271, -0.09449706226587296, -0.06415477395057678, -0.04877544194459915, -0.03954901546239853, -0.034109942615032196, -0.07850594818592072, -0.11430931836366653, -0.13698440790176392, -0.12968134880065918, -0.1470136046409607, -0.14208084344863892, -0.12834486365318298, -0.11680052429437637, -0.1069556251168251, -0.10280350595712662, -0.10369426757097244, -0.10458303242921829, -0.12881982326507568, -0.15769070386886597, -0.17594978213310242, -0.15718987584114075, -0.13693439960479736, -0.13688072562217712, -0.1146356388926506, -0.131967693567276, -0.1416536271572113, -0.12609529495239258, -0.11034179478883743, -0.09033384174108505, -0.053395286202430725, -0.03614802658557892, -0.006809763610363007, 0.04133304953575134, 0.11013224720954895, 0.1456136405467987, 0.08302000164985657, 0.005248617380857468, 0.03331994265317917, 0.034497134387493134, -0.041563548147678375, -0.013698939234018326, 0.002857726067304611, 0.03236506134271622, 0.06498442590236664, 0.09785259515047073, 0.12896588444709778, 0.1542803794145584, 0.11779950559139252, 0.03026137873530388, -0.08290375024080276, -0.09997359663248062, -0.134299635887146, -0.11910552531480789, -0.12429403513669968, -0.10901520401239395, -0.1110537126660347, -0.1176084652543068, -0.10926049202680588, -0.10393086820840836, -0.10449779778718948, -0.1215493455529213, -0.09821537882089615, -0.07540661096572876, -0.04693473130464554, -0.09184034913778305, -0.07074125856161118, -0.1067936047911644, -0.08636779338121414, -0.11120814830064774, -0.06805764883756638, -0.04974772781133652, -0.04424650967121124, -0.023491039872169495, 0.01603323221206665, 0.06024908274412155, 0.06990466266870499, 0.06630176305770874, 0.05248727276921272, 0.03715312480926514, 0.03337568789720535, 0.01706605777144432, 0.08376963436603546, 0.07936999201774597, 0.10580918192863464, 0.10779239982366562, 0.11581068485975266, 0.11830849945545197, 0.1479921042919159, 0.17692357301712036, 0.2109084129333496, 0.21415799856185913, 0.19608741998672485, 0.14901715517044067, 0.098600834608078, 0.08090455830097198, 0.059554506093263626, 0.029128700494766235, -0.006283290684223175, -0.03718625009059906, 0.00015971064567565918, 0.011008445173501968, 0.007091064006090164, 0.023711074143648148, 0.028946736827492714, 0.017864011228084564, -0.010153818875551224, -0.021695949137210846, -0.01346312090754509, -0.017281316220760345, 0.038581401109695435, 0.008538942784070969, 0.06069638207554817, 0.03775404021143913, -0.0006976649165153503, -0.050583064556121826, -0.017340049147605896, -0.06504052877426147, 0.014163559302687645, 0.03585705906152725, 0.05299520492553711, 0.07130023837089539, 0.07369466125965118, 0.06361336261034012, 0.04886224865913391, 0.05083475634455681, 0.04368474334478378, 0.03859063237905502, 0.03377394378185272, 0.028026491403579712, 0.03559834137558937, 0.036826085299253464, 0.05607981234788895, 0.12691543996334076, 0.14078179001808167, 0.13528503477573395, 0.11812379956245422, 0.14664629101753235, 0.15189817547798157, 0.16137245297431946, 0.18687647581100464, 0.20980647206306458, 0.20261192321777344, 0.19184741377830505, 0.15467563271522522, 0.12853583693504333, 0.09132847189903259, 0.04514112323522568, 0.03696579486131668, 0.03417792543768883, 0.02956707961857319, 0.010989490896463394, -0.021494247019290924, -0.029469236731529236, -0.02697121351957321, -0.047317422926425934, -0.05473986268043518, -0.072506383061409, -0.09585780650377274, -0.11699039489030838, -0.10155031830072403, -0.10696367174386978, -0.07939192652702332, -0.04529857635498047, -0.051347121596336365, -0.06948812305927277, -0.09372422844171524, -0.0604248121380806, -0.05399785190820694, 0.011325422674417496, 0.06810835003852844, 0.09637212753295898, 0.06203293055295944, 0.06976865977048874, 0.023322496563196182, 0.05665293708443642, 0.05552084743976593, 0.03670429810881615, 0.10030856728553772, 0.10502062737941742, 0.012657472863793373, -0.06732841581106186, -0.07786541432142258, -0.015214517712593079, 0.07889469712972641, 0.0058297328650951385, 0.062058910727500916, -0.022839508950710297, -0.08170600980520248, -0.09472750872373581, -0.03968646377325058, -0.08305364102125168, -0.06532398611307144, -0.10326229780912399, -0.0783969983458519, -0.12878131866455078, -0.14938712120056152, -0.11280330270528793, -0.07331717014312744, -0.10107062011957169, -0.11794865876436234, -0.07917419821023941, -0.0881594642996788, -0.09503182023763657, -0.10199246555566788, -0.09231754392385483, -0.06363566219806671, 0.018125463277101517, -0.006286606192588806, -0.03062218427658081, -0.024085618555545807, 0.024859750643372536, 0.07315940409898758, 0.09314103424549103, 0.09424455463886261, 0.08048096299171448, 0.0988079383969307, 0.06440259516239166, 0.07914991676807404, 0.07749415189027786, 0.07155808806419373, 0.08038581907749176, 0.10338136553764343]


new_var = [0.5012787580490112, 0.5012787580490112, 0.5012787580490112, 0.5012787580490112, 0.5012787580490112, 0.5012787580490112, 0.5012787580490112, 0.5012787580490112, 0.5012787580490112, 0.5012787580490112, 0.5012787580490112, 0.5012787580490112, 0.5012787580490112, 0.5012787580490112, 0.46000000834465027, 0.46000000834465027, 0.46000000834465027, 0.46000000834465027, 0.46000000834465027, 0.46000000834465027, 0.46000000834465027, 0.46000000834465027, 0.46000000834465027, 0.46000000834465027, 0.46000000834465027, 0.46000000834465027, 0.37962964177131653, 0.37962964177131653, 0.37962964177131653, 0.37962964177131653, 0.37962964177131653, 0.37962964177131653, 0.37962964177131653, 0.37962964177131653, 0.37962964177131653, 0.37962964177131653, 0.37962964177131653, 0.37962964177131653, 0.37962964177131653, 0.37962964177131653, 0.37962964177131653, 0.37962964177131653, 0.37962964177131653, 0.37962964177131653, 0.4861878454685211, 0.4861878454685211, 0.4861878454685211, 0.4861878454685211, 0.4861878454685211, 0.4861878454685211, 0.4861878454685211, 0.4861878454685211, 0.4861878454685211, 0.4861878454685211, 0.4861878454685211, 0.4861878454685211, 0.4861878454685211, 0.4861878454685211, 0.4861878454685211, 0.4861878454685211, 0.4861878454685211, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.5074999928474426, 0.42500001192092896, 0.42500001192092896, 0.42500001192092896, 0.42500001192092896, 0.42500001192092896, 0.42500001192092896, 0.42500001192092896, 0.42500001192092896, 0.42500001192092896, 0.42500001192092896, 0.42500001192092896, 0.42500001192092896, 0.42500001192092896, 0.42500001192092896, 0.42500001192092896, 0.42500001192092896, 0.42500001192092896, 0.42500001192092896, 0.42500001192092896, 0.42500001192092896, 0.3221476376056671, 0.3221476376056671, 0.3221476376056671, 0.3221476376056671, 0.3221476376056671, 0.3221476376056671, 0.3221476376056671, 0.3221476376056671, 0.3221476376056671, 0.3221476376056671, 0.3221476376056671, 0.3221476376056671, 0.3221476376056671, 0.3221476376056671, 0.39298245310783386, 0.39298245310783386, 0.39298245310783386, 0.39298245310783386, 0.39298245310783386, 0.39298245310783386, 0.39298245310783386, 0.39298245310783386, 0.39298245310783386, 0.39298245310783386, 0.39298245310783386, 0.39298245310783386, 0.39298245310783386, 0.39298245310783386, 0.3507108986377716, 0.3507108986377716, 0.3507108986377716, 0.3507108986377716, 0.3507108986377716, 0.3507108986377716, 0.3507108986377716, 0.3507108986377716, 0.3507108986377716, 0.3507108986377716, 0.3507108986377716, 0.3507108986377716, 0.3507108986377716, 0.3507108986377716, 0.3507108986377716, 0.3507108986377716, 0.3507108986377716, 0.3507108986377716, 0.3507108986377716, 0.3507108986377716, 0.3507108986377716, 0.3507108986377716, 0.3507108986377716, 0.3507108986377716, 0.3507108986377716, 0.4074999988079071, 0.4074999988079071, 0.4074999988079071, 0.4074999988079071, 0.4074999988079071, 0.4074999988079071, 0.4074999988079071, 0.4074999988079071, 0.4074999988079071, 0.4074999988079071, 0.4074999988079071, 0.4074999988079071, 0.4074999988079071, 0.4074999988079071, 0.4074999988079071, 0.4074999988079071, 0.4074999988079071, 0.4074999988079071, 0.4074999988079071, 0.5345911979675293, 0.5345911979675293, 0.5345911979675293, 0.5345911979675293, 0.5345911979675293, 0.5345911979675293, 0.5345911979675293, 0.5345911979675293, 0.5345911979675293, 0.5345911979675293, 0.5345911979675293, 0.5345911979675293, 0.5345911979675293, 0.5345911979675293, 0.5345911979675293, 0.5345911979675293, 0.5345911979675293, 0.5345911979675293, 0.5345911979675293, 0.5345911979675293, 0.5345911979675293, 0.5345911979675293, 0.5345911979675293, 0.48249998688697815, 0.48249998688697815, 0.48249998688697815, 0.48249998688697815, 0.48249998688697815, 0.48249998688697815, 0.48249998688697815, 0.48249998688697815, 0.48249998688697815, 0.48249998688697815, 0.48249998688697815, 0.48249998688697815, 0.48249998688697815, 0.48249998688697815, 0.48249998688697815, 0.48249998688697815, 0.48249998688697815, 0.48249998688697815, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.4226190447807312, 0.41999998688697815, 0.41999998688697815, 0.41999998688697815, 0.41999998688697815, 0.41999998688697815, 0.41999998688697815, 0.41999998688697815, 0.41999998688697815, 0.41999998688697815, 0.41999998688697815, 0.41999998688697815, 0.41999998688697815, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5899999737739563, 0.5924999713897705, 0.5924999713897705, 0.5924999713897705, 0.5924999713897705, 0.5924999713897705, 0.5924999713897705, 0.5924999713897705, 0.5924999713897705, 0.5924999713897705, 0.5924999713897705, 0.5924999713897705, 0.5924999713897705, 0.4601770043373108, 0.4601770043373108, 0.4601770043373108, 0.4601770043373108, 0.4601770043373108, 0.4601770043373108, 0.4601770043373108, 0.4601770043373108, 0.4601770043373108, 0.4601770043373108, 0.4601770043373108, 0.4601770043373108, 0.4601770043373108, 0.4601770043373108, 0.4601770043373108, 0.4601770043373108, 0.55409836769104, 0.55409836769104, 0.55409836769104, 0.55409836769104, 0.55409836769104, 0.55409836769104, 0.55409836769104, 0.55409836769104, 0.55409836769104, 0.55409836769104, 0.55409836769104, 0.55409836769104, 0.55409836769104, 0.55409836769104, 0.55409836769104, 0.55409836769104, 0.55409836769104, 0.55409836769104, 0.55409836769104, 0.55409836769104, 0.55409836769104, 0.55409836769104, 0.55409836769104, 0.55409836769104, 0.4356435537338257, 0.4356435537338257, 0.4356435537338257, 0.4356435537338257, 0.4356435537338257, 0.4356435537338257, 0.4356435537338257, 0.4356435537338257, 0.4356435537338257, 0.4356435537338257, 0.4356435537338257, 0.4356435537338257, 0.4356435537338257, 0.4356435537338257, 0.4356435537338257, 0.4356435537338257, 0.4356435537338257, 0.4356435537338257, 0.4356435537338257, 0.4356435537338257, 0.4356435537338257, 0.4356435537338257, 0.4356435537338257, 0.4356435537338257, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.48500001430511475, 0.3449999988079071, 0.3449999988079071, 0.3449999988079071, 0.3449999988079071, 0.3449999988079071, 0.32499998807907104, 0.32499998807907104, 0.32499998807907104, 0.32499998807907104, 0.32499998807907104, 0.32499998807907104, 0.32499998807907104, 0.32499998807907104, 0.32499998807907104, 0.32499998807907104, 0.32499998807907104, 0.32499998807907104, 0.32499998807907104, 0.32499998807907104, 0.32499998807907104, 0.32499998807907104, 0.32499998807907104, 0.32499998807907104, 0.32499998807907104, 0.32499998807907104, 0.32499998807907104, 0.32499998807907104, 0.32499998807907104, 0.32499998807907104, 0.32499998807907104, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.38118812441825867, 0.4113207459449768, 0.4113207459449768, 0.4113207459449768, 0.4113207459449768, 0.4113207459449768, 0.4113207459449768, 0.4113207459449768, 0.4113207459449768, 0.4113207459449768, 0.4113207459449768, 0.4113207459449768, 0.4113207459449768, 0.4113207459449768, 0.4113207459449768, 0.4113207459449768, 0.4113207459449768, 0.4113207459449768, 0.4113207459449768, 0.4113207459449768, 0.4113207459449768, 0.4113207459449768, 0.4113207459449768, 0.4113207459449768, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3774999976158142, 0.3774999976158142, 0.3774999976158142, 0.3774999976158142, 0.3774999976158142, 0.3774999976158142, 0.3774999976158142, 0.3774999976158142, 0.3774999976158142, 0.3774999976158142, 0.3774999976158142, 0.3774999976158142, 0.3774999976158142, 0.3774999976158142, 0.3774999976158142, 0.3774999976158142, 0.3774999976158142, 0.3774999976158142, 0.3774999976158142, 0.3774999976158142, 0.3774999976158142, 0.3774999976158142, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.36666667461395264, 0.4124999940395355, 0.4124999940395355, 0.4124999940395355, 0.4124999940395355, 0.4124999940395355, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.4350000023841858, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3799999952316284, 0.3725000023841858, 0.3725000023841858, 0.3725000023841858, 0.3725000023841858, 0.3725000023841858, 0.3725000023841858, 0.3725000023841858, 0.3725000023841858, 0.3725000023841858, 0.3725000023841858, 0.3502824902534485, 0.3502824902534485, 0.3502824902534485, 0.3502824902534485, 0.3502824902534485, 0.3502824902534485, 0.3502824902534485, 0.3502824902534485, 0.3502824902534485, 0.3502824902534485, 0.3502824902534485, 0.3502824902534485, 0.3502824902534485, 0.3502824902534485, 0.3502824902534485, 0.3502824902534485, 0.3502824902534485, 0.3502824902534485, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.35329341888427734, 0.42750000953674316, 0.42750000953674316, 0.42750000953674316, 0.42750000953674316, 0.42750000953674316, 0.42750000953674316, 0.42750000953674316, 0.42750000953674316, 0.42750000953674316, 0.42750000953674316, 0.42750000953674316, 0.42750000953674316, 0.42750000953674316, 0.42750000953674316, 0.42750000953674316, 0.42750000953674316, 0.42750000953674316, 0.42750000953674316, 0.42750000953674316, 0.42750000953674316, 0.42750000953674316]
if len(this_predictions) == len(this_labels) and len(this_labels) == len(v1) and len(v1) == len(v2) and len(new_var) == len(v2):
    print("correct")

#hier wird die Genauigkeit des ersten Modelles auf die letzten 100 labels gestestet um dann unten mit der Genauigkeit des zweiten Modelles verglichen zu werden
ep = this_predictions[-101:-1]
el = this_labels[-101:-1]
c = 0
for i in range(len(el)):
    if ep[i] == el[i]:
        c += 1
print(len(el))
print(c / len(el))
print(ep)
print(el)

#neues datenset
features_df = pd.DataFrame({'sentiment': new_var, 'pred1':v1, 'pred2': v2, 'label': this_labels})

features_df['label'] = features_df['label'].shift(1) #wieder ein shift um den späteren zu kompensieren
features_df = features_df.dropna()
print(features_df)




#-------------------------------------------------------------------------------------------------------------
len_feat_df = len(features_df)
train_df, test_df = features_df[:-130], features_df[-130:]
def create_sequences(input_data: pd.DataFrame, target_column, sequence_length):
    sequences = []
    data_size = len(input_data)
    for i in range(data_size - sequence_length):
        sequence = input_data[i:i+sequence_length]
        label_position = i  + sequence_length
        label = input_data.iloc[label_position][target_column]
        sequences.append((sequence, label))
    return sequences

SEQUENCE_LENGTH = 30
train_sequences = create_sequences(train_df, "label", SEQUENCE_LENGTH)
test_sequences = create_sequences(test_df, "label", SEQUENCE_LENGTH)



import random
def counter(seq):
    counter = 0
    for i in range(len(seq)):
        if seq[i][1] == 1:
            counter += 1
    return 2 * counter - len(seq)

print(counter(train_sequences))
print(counter(test_sequences))
def correct(seq):
    i = 0
    n = (len(seq)) - 1
    x = counter(seq)
    while i < x:
        r = random.randint(0, n)
        if seq[r][1] == 1:
            m = seq.pop(r)
            i += 1
            n -= 1
        
    return seq
            

test_sequences = correct(test_sequences)
train_sequences = correct(train_sequences)
#-------------------------------------------------------------------------------------------------------------
class APPLDataset(Dataset):
    def __init__(self, sequences):
        self.sequences = sequences
    def __len__(self):
        return len(self.sequences)
    def __getitem__(self, idx):
        sequence, label = self.sequences[idx]
        return dict(sequence=torch.Tensor(sequence.to_numpy()), label=torch.tensor(label).long())
class APPLPriceDataModule(pl.LightningDataModule):
    def __init__(self, train_sequences, test_sequences, batch_size):
        super().__init__()
        self.train_sequences = train_sequences
        self.test_sequences = test_sequences
        self.batch_size = batch_size
    def setup(self, stage=None):
        self.train_dataset = APPLDataset(self.train_sequences)
        self.test_dataset = APPLDataset(self.test_sequences)
    def train_dataloader(self):
        return DataLoader(self.train_dataset, batch_size=self.batch_size, shuffle=False)
    #def val_dataloader(self):
        #return DataLoader(self.test_dataset, batch_size=1, shuffle=False)
    def test_dataloader(self):
        return DataLoader(self.test_dataset, batch_size=1, shuffle=False)
#-------------------------------------------------------------------------------------------------------------
N_EPOCHS = 200
BATCH_SIZE = 64
n_features=4
data_module = APPLPriceDataModule(train_sequences, test_sequences, BATCH_SIZE)
data_module.setup()
#-------------------------------------------------------------------------------------------------------------
class PricePredictionModel(nn.Module):
    def __init__(self, features, n_classes, n_hidden=256, n_layers=3):
        super().__init__()
        #self.n_hidden = n_hidden
        self.lstm = nn.LSTM(input_size=n_features, hidden_size=n_hidden, batch_first=True, num_layers=n_layers, dropout=0.8)  
        self.classifier = nn.Linear(n_hidden, n_classes)
    def forward(self, x):
        self.lstm.flatten_parameters()
        _, (hidden, _) = self.lstm(x)
        out = hidden[-1]
        return self.classifier(out)
#-------------------------------------------------------------------------------------------------------------
class APPLPricePredictor(pl.LightningModule):
    def __init__(self, n_features=4, n_classes=2):
        super().__init__()
        self.model = PricePredictionModel(n_features, n_classes)
        self.criterion = nn.CrossEntropyLoss()
    def forward(self, x, labels=None):
        output = self.model(x)
        loss = 0
        if labels is not None:
            loss = self.criterion(output, labels)
        return loss, output
    def training_step(self, batch ,batch_idx):
        sequences = batch["sequence"]
        labels = batch["label"]
        loss, outputs = self(sequences, labels)
        predictions = torch.argmax(outputs, dim=1)
        step_accuracy = accuracy(predictions, labels)
        return {"loss": loss, "accuracy": step_accuracy}
    def test_step(self, batch ,batch_idx):
        print("happens")
        sequences = batch["sequence"]
        labels = batch["label"]
        loss, outputs = self(sequences, labels)
        predictions = torch.argmax(outputs, dim=1)
        step_accuracy = accuracy(predictions, labels)
        return {"loss": loss, "accuracy": step_accuracy}
    def configure_optimizers(self):
        return optim.AdamW(self.parameters(), lr=0.0001)
#-------------------------------------------------------------------------------------------------------------
that_model = APPLPricePredictor(n_features=train_df.shape[1], n_classes=2)
#-------------------------------------------------------------------------------------------------------------
trainer = pl.Trainer(max_epochs=N_EPOCHS)
trainer.fit(that_model, data_module)
#evaluation
that_model.eval()
test_dataset = APPLDataset(test_sequences)
my_predictions = []
my_labels=[]
my_outputs = []
for item in test_dataset:
    sequence = item["sequence"]
    label = item["label"]
    _, output = that_model(sequence.unsqueeze(dim=0))
    prediction = torch.argmax(output, dim=1)
    my_outputs.append(output)
    my_predictions.append(prediction.item())
    my_labels.append(label.item())
correct = 0
for i in range(len(my_predictions)):
    if my_labels[i] == my_predictions[i]:
        correct += 1
f = correct / len(my_predictions )* 100
print(f)

#jetzt folgt auch hier ein Test mit realen Klassenverteilungen
newest_df = features_df[-130:]
newest_sequences = create_sequences(newest_df, "label", SEQUENCE_LENGTH)
that_model.eval()
newest_dataset = APPLDataset(newest_sequences)
newest_predictions = []
newest_labels=[]
for item in newest_dataset:
    sequence = item["sequence"]
    label = item["label"]
    _, output = that_model(sequence.unsqueeze(dim=0))
    prediction = torch.argmax(output, dim=1)
    newest_predictions.append(prediction.item())
    newest_labels.append(label.item())
correct = 0
for i in range(len(my_predictions)):
    if newest_labels[i] == newest_predictions[i]:
        correct += 1
f = correct / len(newest_predictions )* 100
print(f)
c = 0
for element in newest_labels: #berechnet den Anteil von positiven Kursentwicklungen
    if element == 1:
        c += 1
print(c / len(newest_labels))
